function reorder_init(){lis=document.getElementsBySelector("ul#orderthese li");var e=document.getElementsBySelector("input[name=order_]")[0];setOrder(e.value.split(","));e.disabled=!0;draw();var t=(lis.length-1)*height;for(var n=0;n<lis.length;n++){var r=lis[n],i=document.getElementById("handle"+r.id);r.style.zIndex=1;Drag.init(i,r,left+10,left+10,top+10,top+10+t);r.onDragStart=startDrag;r.onDragEnd=endDrag;i.style.cursor="move"}}function submitOrderForm(){var e=document.getElementsBySelector("input[name=order_]")[0];e.value=getOrder();e.disabled=!1}function startDrag(){this.style.zIndex="10";this.className="dragging"}function endDrag(e,t){this.style.zIndex="1";this.className="";var n=this.index,r=Math.round((t-10-top)/height);this.style.top=10+top+r*height+"px";this.index=r;moveItem(n,r)}function moveItem(e,t){if(e==t)return;var n,r,i;if(t>e){r=e;i=t;n=-1}else{n=1;i=e;r=t}var s=new Array;for(var o=0;o<lis.length;o++){if(o<r||o>i){s[o]=lis[o];continue}if(o==t){s[o]=lis[e];continue}s[o]=lis[o-n]}reIndex(s);lis=s;draw();document.getElementsBySelector("input[name=order_]")[0].value=getOrder()}function reIndex(e){for(var t=0;t<e.length;t++)e[t].index=t}function draw(){for(var e=0;e<lis.length;e++){var t=lis[e];t.index=e;t.style.position="absolute";t.style.left=10+left+"px";t.style.top=10+top+e*height+"px"}}function getOrder(){var e=new Array(lis.length);for(var t=0;t<lis.length;t++)e[t]=lis[t].id.substring(1,100);return e.join(",")}function setOrder(e){var t=new Array;for(var n=0;n<e.length;n++){var r="p"+e[n];t[t.length]=document.getElementById(r)}reIndex(t);lis=t;draw()}function addEvent(e,t,n,r){if(e.addEventListener){e.addEventListener(t,n,r);return!0}if(e.attachEvent){var i=e.attachEvent("on"+t,n);return i}e["on"+t]=n}addEvent(window,"load",reorder_init);var lis,top=0,left=0,height=30;