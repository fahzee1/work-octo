// Handles related-objects functionality: lookup link for raw_id_fields
// and Add Another links.
function html_unescape(e){e=e.replace(/&lt;/g,"<");e=e.replace(/&gt;/g,">");e=e.replace(/&quot;/g,'"');e=e.replace(/&#39;/g,"'");e=e.replace(/&amp;/g,"&");return e}function id_to_windowname(e){e=e.replace(/\./g,"__dot__");e=e.replace(/\-/g,"__dash__");return e}function windowname_to_id(e){e=e.replace(/__dot__/g,".");e=e.replace(/__dash__/g,"-");return e}function showRelatedObjectLookupPopup(e){var t=e.id.replace(/^lookup_/,"");t=id_to_windowname(t);var n;e.href.search(/\?/)>=0?n=e.href+"&pop=1":n=e.href+"?pop=1";var r=window.open(n,t,"height=500,width=800,resizable=yes,scrollbars=yes");r.focus();return!1}function dismissRelatedLookupPopup(e,t){var n=windowname_to_id(e.name),r=document.getElementById(n);r.className.indexOf("vManyToManyRawIdAdminField")!=-1&&r.value?r.value+=","+t:document.getElementById(n).value=t;e.close()}function showAddAnotherPopup(e){var t=e.id.replace(/^add_/,"");t=id_to_windowname(t);href=e.href;href.indexOf("?")==-1?href+="?_popup=1":href+="&_popup=1";var n=window.open(href,t,"height=500,width=800,resizable=yes,scrollbars=yes");n.focus();return!1}function dismissAddAnotherPopup(e,t,n){t=html_unescape(t);n=html_unescape(n);var r=windowname_to_id(e.name),i=document.getElementById(r);if(i)if(i.nodeName=="SELECT"){var s=new Option(n,t);i.options[i.options.length]=s;s.selected=!0}else i.nodeName=="INPUT"&&(i.className.indexOf("vManyToManyRawIdAdminField")!=-1&&i.value?i.value+=","+t:i.value=t);else{var o=r+"_to";i=document.getElementById(o);var s=new Option(n,t);SelectBox.add_to_cache(o,s);SelectBox.redisplay(o)}e.close()};