// VERSION: 1.8 LAST UPDATE: 9.03.2011
/*
 * Licensed under the MIT license: http://www.opensource.org/licenses/mit-license.php
 *
 * Made by Wilq32, wilq32@gmail.com, Wroclaw, Poland, 01.2009
 * Website: http://code.google.com/p/jqueryrotate/
 */// Documentation removed from script file (was kinda useless and outdated)
(function($){var supportedCSS,styles=document.getElementsByTagName("head")[0].style,toCheck="transformProperty WebkitTransform OTransform msTransform MozTransform".split(" ");for(var a=0;a<toCheck.length;a++)styles[toCheck[a]]!==undefined&&(supportedCSS=toCheck[a]);var IE=eval('"v"==""');jQuery.fn.extend({ImageRotate:function(e){if(this.Wilq32&&this.Wilq32.PhotoEffect)return;var t=$.extend(!0,{},e);return(new Wilq32.PhotoEffect(this.get(0),t))._rootObj},rotate:function(e){if(this.length===0||typeof e=="undefined")return;typeof e=="number"&&(e={angle:e});var t=[];for(var n=0,r=this.length;n<r;n++){var i=this.get(n);typeof i.Wilq32=="undefined"?t.push($($(i).ImageRotate(e))):i.Wilq32.PhotoEffect._handleRotation(e)}return t}});Wilq32=window.Wilq32||{};Wilq32.PhotoEffect=function(){return supportedCSS?function(e,t){e.Wilq32={PhotoEffect:this};this._img=this._rootObj=this._eventObj=e;this._handleRotation(t)}:IE?function(e,t){this._img=e;this._rootObj=document.createElement("span");this._rootObj.style.display="inline-block";this._rootObj.Wilq32={PhotoEffect:this};e.parentNode.insertBefore(this._rootObj,e);this._Loader(t)}:function(e,t){this._rootObj=e}}();Wilq32.PhotoEffect.prototype={_setupParameters:function(e){this._parameters=this._parameters||{};typeof this._angle!="number"&&(this._angle=0);typeof e.angle=="number"&&(this._angle=e.angle);this._parameters.animateTo=typeof e.animateTo=="number"?e.animateTo:this._angle;this._parameters.easing=e.easing||this._parameters.easing||function(e,t,n,r,i){return-r*((t=t/i-1)*t*t*t-1)+n};this._parameters.duration=e.duration||this._parameters.duration||1e3;this._parameters.callback=e.callback||this._parameters.callback||function(){};e.bind&&e.bind!=this._parameters.bind&&this._BindEvents(e.bind)},_handleRotation:function(e){this._setupParameters(e);this._angle==this._parameters.animateTo?this._rotate(this._angle):this._animateStart()},_BindEvents:function(e){if(e&&this._eventObj){if(this._parameters.bind){var t=this._parameters.bind;for(var n in t)t.hasOwnProperty(n)&&jQuery(this._eventObj).unbind(n,t[n])}this._parameters.bind=e;for(var n in e)e.hasOwnProperty(n)&&jQuery(this._eventObj).bind(n,e[n])}},_Loader:function(e){var t=this._img.width,n=this._img.height;this._rootObj.appendChild(this._img);this._rootObj.style.width=this._img.offsetWidth;this._rootObj.style.height=this._img.offsetHeight;this._img.style.position="absolute";this._rootObj=this._img;this._rootObj.Wilq32={PhotoEffect:this};this._rootObj.style.filter+="progid:DXImageTransform.Microsoft.Matrix(M11=1,M12=1,M21=1,M22=1,sizingMethod='auto expand')";this._eventObj=this._rootObj;this._handleRotation(e)},_animateStart:function(){this._timer&&clearTimeout(this._timer);this._animateStartTime=+(new Date);this._animateStartAngle=this._angle;this._animate()},_animate:function(){var e=+(new Date),t=e-this._animateStartTime>this._parameters.duration;if(t&&!this._parameters.animatedGif)clearTimeout(this._timer);else{if(this._canvas||this._vimage||this._img){var n=this._parameters.easing(0,e-this._animateStartTime,this._animateStartAngle,this._parameters.animateTo-this._animateStartAngle,this._parameters.duration);this._rotate(~~(n*10)/10)}var r=this;this._timer=setTimeout(function(){r._animate.call(r)},10)}if(this._parameters.callback&&t){this._angle=this._parameters.animateTo;this._rotate(this._angle);this._parameters.callback.call(this._rootObj)}},_rotate:function(){var e=Math.PI/180;if(IE)return function(t){this._angle=t;var n=t*e;costheta=Math.cos(n);sintheta=Math.sin(n);var r=this._rootObj.filters.item("DXImageTransform.Microsoft.Matrix");r.M11=costheta;r.M12=-sintheta;r.M21=sintheta;r.M22=costheta;this._rootObj.style.marginLeft=-(this._rootObj.offsetWidth-this._rootObj.clientWidth)/2+"px";this._rootObj.style.marginTop=-(this._rootObj.offsetHeight-this._rootObj.clientHeight)/2+"px"};if(supportedCSS)return function(e){this._angle=e;this._img.style[supportedCSS]="rotate("+e%360+"deg)"}}()}})(jQuery);