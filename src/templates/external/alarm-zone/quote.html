{% extends "external/alarm-zone/base.html" %}
{% load content_filters content_tags sekizai_tags %}


{% block content %}

<!-- Primary Page Layout
================================================== -->

<div class="super container top">
    <div class="header">
        <a href="/">
            <div class="logo"></div>
                <div class="logo_mobile">
                    <object type="image/svg+xml" width="100" height="22" data="{{ STATIC_URL }}img/external-lp/alarmzone/logo.svg"></object>
                </div>
        </a>
        <div class="call">
            <p>Call today</p>
            <h2>1-800-951-5190</h2>
        </div>
    </div>
    <div class="nav">
        <ul>
            <li><a href="/" class="index-link">Home</a></li>
            <li><a href="{% url build-package %}" class="build-link">Build a Package</a></li>
            <li><a href="{% url equipment-page %}" class="equipment-link">Equipment</a></li>
            <li><a href="{% url learn-more %}" class="learn-link">Learn More</a></li>
            <li><a href="{% url request-quote %}" class="request-link">Request a Quote</a></li>
        </ul>
    </div>
</div>

<div class="super container">
    <div class="full width">
        <div class="quote">
            <div class="container">
                <div class="sixteen columns">
                </div>
            </div>
        </div>
    </div>
</div>

<div class="container">
    <div class="sixteen columns">
        <div class="build-step4">
            <h3>Request a Quote</h3>
            <ul>
                <li>
                    <form method="POST" action="" class="alarm-quote">
                        {% csrf_token %}
                        <p>Name</p>
                        <input tabindex="1" type="textfield" id="id_name" name="name">
                        <p>Email</p>
                        <input tabindex="2" type="textfield" id="id_email" name="email">
                        <p>Phone</p>
                        <input tabindex="3" type="textfield" id="id_phone" name="phone">
                        <button tabindex="4" type="button" id="submit" name="submit">submit your info</button>
                        <small>By clicking this button, you consent to receive calls using automated technology from Protect America at the number provided and understand this is not a condition of purchase.</small>
                    </form>
                </li>
                <div style="clear: both;">
            </ul>
        </div>
    </div>
</div>

{% addtoblock "js" %}
{% block javascript %}
<script type="text/javascript">
$(document).ready(function(){

$("form #submit").click(function(){
    $("form #submit").attr('disabled',true);
    var $form = $(this).closest('.alarm-quote');
    var name = $form.find("#id_name").val();
    var email = $form.find("#id_email").val();
    var phone = $form.find("#id_phone").val();
    var data ={
            'form': 'basic',
             'name':name,
             'email':email,
             'phone':phone,
             'trusted_form': $form.find("[name ='xxTrustedFormToken']").val()
         }


    $.ajax({
            type: "POST",
            url: "/contact/ajaxpost/",
            data: data,
            dataType: "json",
            success: newFormSuccess,
            error: newFormError,
            beforeSend:function(){
                    //$(".sleepy .icon-chevron-right, .droopy .icon-chevron-right").hide();
                    //$(".sleepy #form-loading, .droopy #form-loading").show();
                    $("form #submit").attr('disabled',true);
                    $("form #submit");
                    }
            }); // end ajax
       

     function newFormError(){
            //$(".sleepy #form-loading, .droopy #form-loading").hide();
            //$(".sleepy .icon-chevron-right, .droopy .icon-chevron-right").show();
            $("form #submit").attr('disabled',false);
            $("form #submit").text('SUBMIT YOUR INFO');
            if (!name && !phone){
                $('#id_name').addClass('error').attr('placeholder','Please enter your name');
                $('#id_phone').addClass('error').attr('placeholder','Please enter phone number');
                alert('Please enter your name and phone number.');
            }
            if (!phone && name){
                $('#id_phone').addClass('error').attr('placeholder','Please enter phone number');
                alert('Please enter your phone number.');
            }
            if (!name && phone){
                $('#id_name').addClass('error').attr('placeholder','Please enter your name');
                alert('Please enter your name.');
            }
            if (name){
                $('#id_name').addClass('error');
            }
            if (phone){
                $('#id_phone').addClass('error');
            }
        } // end newformerror


        function newFormSuccess(json) {
            //$('#form-loading').hide();
            if(json.success) {
                {% if thank_you %}
                window.location = '{{ thank_you }}';
                {% else %}
                window.location = "{% url thanks-page %}"
                {% endif %}
                _gaq.push([  
                    '_trackEvent',
                    'Form Click',
                    'Form Events',
                    '{{ page_name }}'
                ]);
                return;
            }
        }
        return false;

    }); // end click function

}); //end document ready 

</script>

{% endblock %}
{% endaddtoblock "js" %}
{% endblock %}